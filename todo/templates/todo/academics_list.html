{% extends 'todo/base.html' %}

{% block content %}

<div class="row">
  <div class="col">
    <h4>Academics Todo!</h4>
  </div>
</div>

<div class="row d-flex justify-content-center flex-wrap">
  {% if course_list %}
      <ul style="list-style-type:none" class="w-50 list-group">
        {% for course in course_list %}
          <li class="container p-3 my-3 border col">
              <h5><strong>
              {% if course.course_abbrev %}
                {{ course.course_abbrev }}:
              {% endif %}
              {{ course.course_name }}
              </strong></h5>

              <div class="row">
                <div class="col">
                  <div class="row d-flex justify-content-center">
                    {% if course.todoitem_set.all %}
                    <ul class="w-100 list-group">
                      <div id="accordion">
                        {% for todo_item in course.todoitem_set.all %}
                          {% if not todo_item.completed and todo_item.category != 'NN' %}
                          <div class="card">
                            <button
                              class="btn collapsed"
                              id="cardButton"
                              data-toggle="collapse"
                              data-target="#collapse{{forloop.counter}}"
                            >
                              <li class="list-group-item">
                                {% if todo_item.priority == "HI" and not todo_item.completed %}
                                <div class="card-header border border-danger" id="header{{forloop.counter}}">
                                {% elif todo_item.priority == "MD" and not todo_item.completed %}
                                <div class="card-header border border-warning" id="header{{forloop.counter}}">
                                {% else %}
                                <div class="card-header border bg-light" id="header{{forloop.counter}}">
                                {% endif %}

                                <p class="d-flex justify-content-start">
                                  {% if not todo_item.completed %}
                                    {{todo_item.title}}
                                  {% else %}
                                    <del>{{todo_item.title}}</del>
                                  {% endif %}
                                </p>

                                <div class="d-flex justify-content-around mt-3">
                                  {% if todo_item.completed %}
                                  <small><i>Task Completed!</i></small>
                                  {% endif %}
                                  <small>due {{todo_item.duedate}}</small>
                                </div>

                            </button>
                              <!--forloop.counter gives each instance of todo_item a different id so each box collapses independently of each other -->
                              <div id="collapse{{forloop.counter}}" class="collapse">
                                <!--body of the accordion card -->
                                <div class="card-body">
                                  <ul style="list-style-type:none">
                                    {% if todo_item.description %}
                                    <li>
                                      <strong>Description:</strong> {{ todo_item.description }}
                                    </li>
                                    {% endif %} {% if todo_item.location %}
                                    <li><strong>Location:</strong> {{ todo_item.location }}</li>
                                    {% endif %}
                                    {% if todo_item.recur_freq %}
                                    <li><strong>Repeat:</strong> {{ todo_item.recur_freq }}</li>
                                    {% endif %}
                                    {% if todo_item.end_recur_date %}
                                    <li>
                                      <strong>End repeat:</strong> {{ todo_item.end_recur_date }}</li>
                                    {% endif %}
                                  </ul>
                                  <div class="row m-sm-3">
                                    <div>
                                      {% if not todo_item.completed %}
                                      <small><a
                                        class="text-success" href="{% url 'todo_list:complete_todo' todo_item.id %}"
                                        >âœ… Complete Task</a
                                      ></small>
                                      {% else %}
                                      <small><a
                                        href="{% url 'todo_list:complete_todo' todo_item.id %}"
                                      >Undo completion</a></small>
                                      {% endif %}
                                    </div>
                                    <div class="ml-auto">
                                      <small class="m-2"
                                        ><a href="{% url 'todo_list:detail' todo_item.id %}"
                                          >ðŸ–Š Edit</a
                                        ></small
                                      >
                                      <small><a
                                        class="text-danger" href="{% url 'todo_list:delete_todo_item' todo_item.id %}"
                                        >ðŸ—‘ Delete</a
                                      ></small>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </li>
                          </div>
                        {% endif %}
                        {% endfor %}
                      </div>
                    </ul>
                    {% else %}
                    <p>You have no to-do items!</p>
                    {% endif %}
                  </div>
                </div>
              </div>
              {% endfor %}
          </li>
      </ul>
  {% endif %}
</div>

<div class="row d-flex justify-content-center">
  <ul style="list-style-type:none" class="w-50 list-group">
      <li class="container p-3 my-3 border col">
          <h5><strong>
          Other
          </strong></h5>
      {% if no_course_todo_list %}
      <div class="row">
        <div class="col">
          <div class="row d-flex justify-content-center">

              <ul class="w-100 list-group">
                <div id="accordion2">
                {% for todo_item in no_course_todo_list %}
                  {% if not todo_item.completed and todo_item.category != 'NN' %}
                  <div class="card">
                    <button
                      class="btn collapsed"
                      id="cardButton2"
                      data-toggle="collapse"
                      data-target="#collapse2{{forloop.counter}}"
                    >
                    <li class="list-group-item">
                      {% if todo_item.priority == "HI" and not todo_item.completed %}
                      <div class="card-header border border-danger" id="header2{{forloop.counter}}">
                      {% elif todo_item.priority == "MD" and not todo_item.completed %}
                      <div class="card-header border border-warning" id="header2{{forloop.counter}}">
                      {% else %}
                      <div class="card-header border bg-light" id="header2{{forloop.counter}}">
                      {% endif %}

                      <p class="d-flex justify-content-start">
                        {% if not todo_item.completed %}
                          {{todo_item.title}}
                        {% else %}
                          <del>{{todo_item.title}}</del>
                        {% endif %}
                      </p>

                      <div class="d-flex justify-content-around mt-3">
                        {% if todo_item.completed %}
                        <small><i>Task Completed!</i></small>
                        {% endif %}
                        <small>due {{todo_item.duedate}}</small>
                      </div>
                    </button>
                      <!--forloop.counter gives each instance of todo_item a different id so each box collapses independently of each other -->
                      <div id="collapse2{{forloop.counter}}" class="collapse">
                        <!--body of the accordion card -->
                        <div class="card-body">
                          <ul style="list-style-type:none">
                            {% if todo_item.description %}
                            <li>
                              <strong>Description:</strong> {{ todo_item.description }}
                            </li>
                            {% endif %} {% if todo_item.location %}
                            <li><strong>Location:</strong> {{ todo_item.location }}</li>
                            {% endif %}
                            {% if todo_item.recur_freq %}
                            <li><strong>Repeat:</strong> {{ todo_item.recur_freq }}</li>
                            {% endif %}
                            {% if todo_item.end_recur_date %}
                            <li>
                              <strong>End repeat:</strong> {{ todo_item.end_recur_date }}</li>
                            {% endif %}
                          </ul>
                          <div class="row m-sm-3">
                            <div>
                              {% if not todo_item.completed %}
                              <small><a
                                class="text-success" href="{% url 'todo_list:complete_todo' todo_item.id %}"
                                >âœ… Complete Task</a
                              ></small>
                              {% else %}
                              <small><a
                                href="{% url 'todo_list:complete_todo' todo_item.id %}"
                              >Undo completion</a></small>
                              {% endif %}
                            </div>
                            <div class="ml-auto">
                              <small class="m-2"
                                ><a href="{% url 'todo_list:detail' todo_item.id %}"
                                  >ðŸ–Š Edit</a
                                ></small
                              >
                              <small><a
                                class="text-danger" href="{% url 'todo_list:delete_todo_item' todo_item.id %}"
                                >ðŸ—‘ Delete</a
                              ></small>
                            </div>
                          </div>
                        </div>
                      </div>
                    </li>
                  </div>
                  {% endif %}
                {% endfor %}
                </div>
              </ul>
          </div>
        </div>
      </div>
      {% else %}
        <p>You have no to-do items!</p>
        {% endif %}
      </li>
  </ul>
</div>
{%endblock%}
